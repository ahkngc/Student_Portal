{% extends "base.html" %}
{% block content %}
<h1>Courses</h1>

{% if user.role == "instructor" %}
  <div class="card">
    <h2>Create Course</h2>
    <form class="row" method="post" action="{{ url_for('courses.create_course_route') }}">
      <input name="code" placeholder="CS301" required>
      <input name="title" placeholder="Database Systems" required>
      <button class="btn btn-primary" type="submit">Create</button>
    </form>
  </div>
{% endif %}

<div class="card">
  <h2>All Courses</h2>
  <table>
    <thead><tr><th>Code</th><th>Title</th><th>Action</th></tr></thead>
    <tbody>
      {% for c in courses %}
        <tr>
          <td>{{ c.code }}</td>
          <td>{{ c.title }}</td>
          <td>
            {% if user.role == "student" %}
              {% if c.id in enrolled_ids %}
                <form method="post" action="{{ url_for('courses.unenroll_route') }}">
                  <input type="hidden" name="course_id" value="{{ c.id }}">
                  <button class="btn btn-outline" type="submit">Unenroll</button>
                </form>
              {% else %}
                <form method="post" action="{{ url_for('courses.enroll_route') }}">
                  <input type="hidden" name="course_id" value="{{ c.id }}">
                  <button class="btn btn-primary" type="submit">Enroll</button>
                </form>
              {% endif %}
            {% else %}
              <span class="muted">â€”</span>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
